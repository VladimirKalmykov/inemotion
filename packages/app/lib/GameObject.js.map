{"version":3,"file":"GameObject.js","names":["GameObject","BaseModule","constructor","scene","Transform2D","Collection","Error","findComponent","ComponentClass","components","find","component","setPosition","x","y","transform","position","addComponent","config","push","getComponent","removeComponent","componentToRemove","index","findIndex","destroy","splice","onStart","onFixedUpdate","updateFrameStamp","onUpdate","app","renderer","translate2D","cancelTranslate2D","onUI"],"sources":["../src/GameObject.ts"],"sourcesContent":["import {\r\n  Component,\r\n  BaseModule,\r\n  AnyClass,\r\n  Transform2D,\r\n  Collection,\r\n  IScene,\r\n} from \"@inemotion/core\";\r\n\r\nexport default class GameObject extends BaseModule {\r\n  public static serializableFields = [\r\n    \"name\",\r\n    \"transform\",\r\n    \"components\",\r\n  ];\r\n  public static hookTypes = [\r\n    \"render\",\r\n    \"fixed-update\",\r\n    \"updated\",\r\n  ];\r\n  public name: string;\r\n  public updateFrameStamp: number = 0;\r\n  public transform: Transform2D = new Transform2D(this);\r\n  public scene: IScene;\r\n  protected components: Collection<Component> = new Collection<Component>();\r\n  constructor(scene: IScene) {\r\n    super();\r\n    if (!scene) {\r\n      throw new Error(\"You must specify scene for the instance of GameObject\");\r\n    }\r\n\r\n    this.scene = scene;\r\n  }\r\n\r\n  public findComponent(ComponentClass: AnyClass): Component {\r\n    return this.components.find((component) => component instanceof ComponentClass);\r\n  }\r\n\r\n  public setPosition(x: number, y: number): void {\r\n    this.transform.position.x = x;\r\n    this.transform.position.y = y;\r\n  }\r\n\r\n  public addComponent(ComponentClass: AnyClass, config?: any): Component {\r\n    const component = new ComponentClass(this, config);\r\n    this.components.push(component);\r\n    return component;\r\n  }\r\n\r\n  public getComponent(ComponentClass: AnyClass): Component {\r\n    return this.components.find(component => component instanceof ComponentClass);\r\n  }\r\n\r\n  public removeComponent(componentToRemove: Component): void {\r\n    const index = this.components.findIndex((component) => component === componentToRemove);\r\n    if (index > -1) {\r\n      componentToRemove.destroy();\r\n      this.components.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  public onStart(): void {\r\n    for (const component of this.components) {\r\n      component.onStart();\r\n    }\r\n  }\r\n\r\n  public onFixedUpdate(): void {\r\n    for (const component of this.components) {\r\n      component.onFixedUpdate();\r\n    }\r\n\r\n    this.updateFrameStamp++;\r\n  }\r\n\r\n  public onUpdate() {\r\n    /* Change rendering context axis position to this object prosition */\r\n    this.scene.app.renderer.translate2D(this.transform.position);\r\n\r\n    for (const component of this.components) {\r\n      component.onUpdate();\r\n    }\r\n\r\n    // Restore axis\r\n    this.scene.app.renderer.cancelTranslate2D(this.transform.position);\r\n  }\r\n\r\n  public onUI() {\r\n    for (const component of this.components) {\r\n      component.onUI();\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;;;;;AAAA;AAOyB;AAAA;AAAA;AAEV,MAAMA,UAAU,SAASC,gBAAU,CAAC;EAgBjDC,WAAW,CAACC,KAAa,EAAE;IACzB,KAAK,EAAE;IAAC;IAAA,0CALwB,CAAC;IAAA,mCACH,IAAIC,iBAAW,CAAC,IAAI,CAAC;IAAA;IAAA,oCAEP,IAAIC,gBAAU,EAAa;IAGvE,IAAI,CAACF,KAAK,EAAE;MACV,MAAM,IAAIG,KAAK,CAAC,uDAAuD,CAAC;IAC1E;IAEA,IAAI,CAACH,KAAK,GAAGA,KAAK;EACpB;EAEOI,aAAa,CAACC,cAAwB,EAAa;IACxD,OAAO,IAAI,CAACC,UAAU,CAACC,IAAI,CAAEC,SAAS,IAAKA,SAAS,YAAYH,cAAc,CAAC;EACjF;EAEOI,WAAW,CAACC,CAAS,EAAEC,CAAS,EAAQ;IAC7C,IAAI,CAACC,SAAS,CAACC,QAAQ,CAACH,CAAC,GAAGA,CAAC;IAC7B,IAAI,CAACE,SAAS,CAACC,QAAQ,CAACF,CAAC,GAAGA,CAAC;EAC/B;EAEOG,YAAY,CAACT,cAAwB,EAAEU,MAAY,EAAa;IACrE,MAAMP,SAAS,GAAG,IAAIH,cAAc,CAAC,IAAI,EAAEU,MAAM,CAAC;IAClD,IAAI,CAACT,UAAU,CAACU,IAAI,CAACR,SAAS,CAAC;IAC/B,OAAOA,SAAS;EAClB;EAEOS,YAAY,CAACZ,cAAwB,EAAa;IACvD,OAAO,IAAI,CAACC,UAAU,CAACC,IAAI,CAACC,SAAS,IAAIA,SAAS,YAAYH,cAAc,CAAC;EAC/E;EAEOa,eAAe,CAACC,iBAA4B,EAAQ;IACzD,MAAMC,KAAK,GAAG,IAAI,CAACd,UAAU,CAACe,SAAS,CAAEb,SAAS,IAAKA,SAAS,KAAKW,iBAAiB,CAAC;IACvF,IAAIC,KAAK,GAAG,CAAC,CAAC,EAAE;MACdD,iBAAiB,CAACG,OAAO,EAAE;MAC3B,IAAI,CAAChB,UAAU,CAACiB,MAAM,CAACH,KAAK,EAAE,CAAC,CAAC;IAClC;EACF;EAEOI,OAAO,GAAS;IACrB,KAAK,MAAMhB,SAAS,IAAI,IAAI,CAACF,UAAU,EAAE;MACvCE,SAAS,CAACgB,OAAO,EAAE;IACrB;EACF;EAEOC,aAAa,GAAS;IAC3B,KAAK,MAAMjB,SAAS,IAAI,IAAI,CAACF,UAAU,EAAE;MACvCE,SAAS,CAACiB,aAAa,EAAE;IAC3B;IAEA,IAAI,CAACC,gBAAgB,EAAE;EACzB;EAEOC,QAAQ,GAAG;IAEhB,IAAI,CAAC3B,KAAK,CAAC4B,GAAG,CAACC,QAAQ,CAACC,WAAW,CAAC,IAAI,CAAClB,SAAS,CAACC,QAAQ,CAAC;IAE5D,KAAK,MAAML,SAAS,IAAI,IAAI,CAACF,UAAU,EAAE;MACvCE,SAAS,CAACmB,QAAQ,EAAE;IACtB;IAGA,IAAI,CAAC3B,KAAK,CAAC4B,GAAG,CAACC,QAAQ,CAACE,iBAAiB,CAAC,IAAI,CAACnB,SAAS,CAACC,QAAQ,CAAC;EACpE;EAEOmB,IAAI,GAAG;IACZ,KAAK,MAAMxB,SAAS,IAAI,IAAI,CAACF,UAAU,EAAE;MACvCE,SAAS,CAACwB,IAAI,EAAE;IAClB;EACF;AACF;AAAC;AAAA,gBAnFoBnC,UAAU,wBACM,CACjC,MAAM,EACN,WAAW,EACX,YAAY,CACb;AAAA,gBALkBA,UAAU,eAMH,CACxB,QAAQ,EACR,cAAc,EACd,SAAS,CACV"}