{"version":3,"file":"Scene.js","names":["Scene","BaseModule","constructor","gameObjects","Collection","onUpdate","gameObject","onUI","onFixedUpdate","addEmptyGameObject","name","go","GameObject","addGameObject","scene","push","getMainCamera","foundedCameras","console","log","camera","getComponent","Camera","length","onStart"],"sources":["../src/Scene.ts"],"sourcesContent":["import {\r\n  BaseModule,\r\n  Collection,\r\n  IApplication,\r\n  IType,\r\n  IScene,\r\n} from \"@inemotion/core\";\r\nimport GameObject from \"./GameObject\";\r\nimport Camera from \"./components/Camera\";\r\n\r\nexport default class Scene extends BaseModule implements IScene {\r\n  public static serializableFields = [\"gameObjects\"];\r\n  public gameObjects: Collection<GameObject>;\r\n  public name: string;\r\n  public app: IApplication;\r\n  public constructor() {\r\n    super();\r\n    this.gameObjects = new Collection<GameObject>();\r\n  }\r\n\r\n  public onUpdate() {\r\n    for (const gameObject of this.gameObjects) {\r\n      gameObject.onUpdate();\r\n    }\r\n  }\r\n\r\n  public onUI() {\r\n    for (const gameObject of this.gameObjects) {\r\n      gameObject.onUI();\r\n    }\r\n  }\r\n\r\n  public onFixedUpdate() {\r\n    for (const gameObject of this.gameObjects) {\r\n      gameObject.onFixedUpdate();\r\n    }\r\n  }\r\n\r\n  /** Create new GameObject */\r\n  public addEmptyGameObject(name: string): GameObject {\r\n    const go = new GameObject(this);\r\n    if (name) {\r\n      go.name = name;\r\n    }\r\n\r\n    return this.addGameObject(go);\r\n  }\r\n\r\n  /** Add GameObject to the scene */\r\n  public addGameObject(gameObject: GameObject | IType<GameObject>): GameObject {\r\n    const go = typeof gameObject === \"function\"\r\n      ? new gameObject(this)\r\n      : gameObject;\r\n    go.scene = this;\r\n    this.gameObjects.push(go);\r\n\r\n    return go;\r\n  }\r\n\r\n  /** Get scene main or single camera */\r\n  public getMainCamera(): Camera {\r\n    const foundedCameras = [];\r\n    console.log('gameObjects', this.gameObjects);\r\n    for (const go of this.gameObjects) {\r\n      const camera = go.getComponent(Camera);\r\n\r\n      if (camera) {\r\n        if (go.name === \"MainCamera\") {\r\n          return camera;\r\n        }\r\n        foundedCameras.push(camera);\r\n      }\r\n    }\r\n\r\n    if (foundedCameras.length > 0) {\r\n      return foundedCameras[0];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /** Triggered on game start */\r\n  public onStart() {\r\n    for (const gameObject of this.gameObjects) {\r\n      gameObject.onStart();\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;;;;;AAAA;AAOA;AACA;AAAyC;AAAA;AAAA;AAAA;AAE1B,MAAMA,KAAK,SAASC,gBAAU,CAAmB;EAKvDC,WAAW,GAAG;IACnB,KAAK,EAAE;IAAC;IAAA;IAAA;IACR,IAAI,CAACC,WAAW,GAAG,IAAIC,gBAAU,EAAc;EACjD;EAEOC,QAAQ,GAAG;IAChB,KAAK,MAAMC,UAAU,IAAI,IAAI,CAACH,WAAW,EAAE;MACzCG,UAAU,CAACD,QAAQ,EAAE;IACvB;EACF;EAEOE,IAAI,GAAG;IACZ,KAAK,MAAMD,UAAU,IAAI,IAAI,CAACH,WAAW,EAAE;MACzCG,UAAU,CAACC,IAAI,EAAE;IACnB;EACF;EAEOC,aAAa,GAAG;IACrB,KAAK,MAAMF,UAAU,IAAI,IAAI,CAACH,WAAW,EAAE;MACzCG,UAAU,CAACE,aAAa,EAAE;IAC5B;EACF;EAGOC,kBAAkB,CAACC,IAAY,EAAc;IAClD,MAAMC,EAAE,GAAG,IAAIC,mBAAU,CAAC,IAAI,CAAC;IAC/B,IAAIF,IAAI,EAAE;MACRC,EAAE,CAACD,IAAI,GAAGA,IAAI;IAChB;IAEA,OAAO,IAAI,CAACG,aAAa,CAACF,EAAE,CAAC;EAC/B;EAGOE,aAAa,CAACP,UAA0C,EAAc;IAC3E,MAAMK,EAAE,GAAG,OAAOL,UAAU,KAAK,UAAU,GACvC,IAAIA,UAAU,CAAC,IAAI,CAAC,GACpBA,UAAU;IACdK,EAAE,CAACG,KAAK,GAAG,IAAI;IACf,IAAI,CAACX,WAAW,CAACY,IAAI,CAACJ,EAAE,CAAC;IAEzB,OAAOA,EAAE;EACX;EAGOK,aAAa,GAAW;IAC7B,MAAMC,cAAc,GAAG,EAAE;IACzBC,OAAO,CAACC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAChB,WAAW,CAAC;IAC5C,KAAK,MAAMQ,EAAE,IAAI,IAAI,CAACR,WAAW,EAAE;MACjC,MAAMiB,MAAM,GAAGT,EAAE,CAACU,YAAY,CAACC,eAAM,CAAC;MAEtC,IAAIF,MAAM,EAAE;QACV,IAAIT,EAAE,CAACD,IAAI,KAAK,YAAY,EAAE;UAC5B,OAAOU,MAAM;QACf;QACAH,cAAc,CAACF,IAAI,CAACK,MAAM,CAAC;MAC7B;IACF;IAEA,IAAIH,cAAc,CAACM,MAAM,GAAG,CAAC,EAAE;MAC7B,OAAON,cAAc,CAAC,CAAC,CAAC;IAC1B;IAEA,OAAO,IAAI;EACb;EAGOO,OAAO,GAAG;IACf,KAAK,MAAMlB,UAAU,IAAI,IAAI,CAACH,WAAW,EAAE;MACzCG,UAAU,CAACkB,OAAO,EAAE;IACtB;EACF;AACF;AAAC;AAAA,gBA7EoBxB,KAAK,wBACW,CAAC,aAAa,CAAC"}